<!doctype html><html><head>
  <meta charset=utf8>
  <title>H2OSEG</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    table{
      border-collapse:collapse;
    }
    tr[sticky]{
      position:sticky;
      top:0;
      background:#eee;
    }
    th{
      background:#eee;
    }

    summary:hover{
      cursor:pointer;
      text-decoration:underline;
    }

    /*font*/
    [monospace]{
      font-family:monospace;
    }

    /*tamany*/
    [smaller]{
      font-size:smaller;
    }
    [xsmall]{
      font-size:x-small;
    }

    /*alineació*/
    [center]{
      text-align:center;
    }
    [right]{
      text-align:right;
    }
  </style>
<head><body>

<p>Pàgina en construcció</b>

<nav>
  <a href="db/db.sqlite">descarregar base de dades SQL</a> |
  <a href="xls/inicial.xlsx">descarregar excel inicial</a>
</nav>

<h1>Projecte H2OSEG - taula fluxos d'aigua (dades crues)</h1>

<div id=app>
  <div v-if="dades">
    <b>Base de dades ({{get_dades.length}})</b>
    <table border=1 monospace>
      <thead>
        <tr sticky>
          <th>Data inici</th>
          <th>Data final</th>
          <th>Lloc</th>
          <th>Volum (m<sup>3</sup>)</th>
          <th>Tipus <small>(entrada/sortida)</small></th>
          <th>Proveïdor dada</th>
          <th>Comentaris</th>
        </tr>
      </thead>
      <tbody smaller>
        <tr v-for="dada,i in get_dades">
          <td center>{{dada.data_inici}}</td>
          <td center>{{dada.data_final}}</td>
          <td center>{{dada.lloc}}</td>
          <td center>{{dada.volum}}</td>
          <td center>{{dada.tipus}}</td>
          <td center>{{dada.proveidor}}</td>
          <td center>{{dada.comentaris}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  class Dada{
    constructor(data_inici,data_final,lloc,volum,tipus,proveidor,comentaris){
      this.data_inici = data_inici ||new Date().toISOString().substring(0,10); //text yyyy-mm-dd
      this.data_final = data_final ||new Date().toISOString().substring(0,10); //text yyyy-mm-dd
      this.lloc       = lloc       ||"lloc";                                   //text
      this.volum      = volum      ||0;                                        //number (m3)
      this.tipus      = tipus      ||"entrada";                                //text "entrada","sortida"
      this.proveidor  = proveidor  ||"proveidor";                              //text
      this.comentaris = comentaris ||"comentaris";                             //text
    }
  }

  let app=Vue.createApp({
    data(){return{
      Dada,
      nova_dada:new Dada(),
      dades:null,
    }},

    methods:{},

    computed:{
      get_dades(){
        let dades = this.dades.filter(row=>row);
        return dades;
      },
    },
  }).mount("#app");

  //llegeix db.sqlite
  fetch("db/api.php").then(r=>r.json()).then(arr=>{
    app.dades=arr;
  });
</script>
